<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.leyou.item.mapper.GoodsMapper">

  <resultMap id="BaseResultMap" type="com.leyou.item.pojo.SpuBo">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 02 16:38:41 CST 2019.
    -->
    <result column="bName" jdbcType="BIGINT" property="bName" />
    <result column="id" jdbcType="BIGINT" property="spuId" />
    <result column="brandId" jdbcType="BIGINT" property="brand_id" />
    <result column="cid1" jdbcType="VARCHAR" property="cid1" />
    <result column="cid2" jdbcType="BIT" property="cid2" />
    <result column="cid3" jdbcType="BIGINT" property="cid3" />
    <result column="title" jdbcType="TIMESTAMP" property="title" />
    <result column="subTitle" jdbcType="VARCHAR" property="sub_title" />
  </resultMap>

  <sql id="baseInfo">
      spuId,
      title,
      bName,
      brand_id,
      cid1,
      cid2,
      cid3,
      sub_title,
      saleable
  </sql>

  <select id="findByPage" resultType="com.leyou.item.pojo.SpuBo">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 02 16:38:41 CST 2019.
    -->
    SELECT
      <include refid="baseInfo"/>
    FROM
      (SELECT
          sp.id AS spuId,
          sp.title,
          br. NAME AS bName,
          sp.brand_id,
          sp.cid1,
          sp.cid2,
          sp.cid3,
          sp.sub_title,sp.saleable
      FROM
        tb_spu sp
      LEFT JOIN tb_brand br ON sp.brand_id = br.id
      ) tb
      <where>
        <if test="key !=null and key !=''">
          bName = #{key}
        </if>
        <if test="saleable !=null">
            saleable = #{saleable}
        </if>
      </where>
     limit #{start},#{end}
  </select>


</mapper>